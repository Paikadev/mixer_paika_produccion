<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    

     <!-- Voxeet SDK and jQuery the CDN unpkg.com -->
     <script type="text/javascript" src="https://unpkg.com/@voxeet/voxeet-web-sdk@3.4"></script>
     <script type="text/javascript" src="https://unpkg.com/jquery"></script>
     
     <!-- Mixer layout script and styles -->
     <script type="text/javascript" src="script.js"></script>
     <script type="text/javascript" src="events.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>

<body>

    <div class="hide">
        <input type="hidden" value="accessToken" id="accessToken" name="accessToken" />
        <input type="hidden" value="refreshToken" id="refreshToken" name="refreshToken" />
        <input type="hidden" value="refreshUrl" id="refreshUrl" name="refreshUrl" />
        <input type="hidden" value="catToken" id="catToken" name="catToken" />
        <input type="hidden" value="voxeet" id="conferenceId" name="conferenceId" />
        <input type="hidden" value="1234" id="thirdPartyId" name="thirdPartyId" />
        <input type="hidden" value="stream" id="layoutType" name="layoutType" />
        <button id="joinConference">Join conference</button>
        <button id="replayConference">Replay conference</button>
    </div>







    <div id="blueDiv"></div>
    <div id="greenDiv"></div>
    <div id="redDivContainer">
        <div class="redDiv">
            <img src="image.jpg" alt="Image" style="width: 200px;">
        </div>
        <div class="redDiv videos-container">
            <p>Camara</p>
        </div>
        <div class="redDiv" id="divInfo">
            <div id="textPrompt">
            </div>
            <div id="timerPrompt">
                15
            </div>
            <div id="divTypePrompt">
               
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <script>
        var socket = io.connect('http://13.52.68.186:9000');

        var lobbyShow = true;
        var type = "";


        socket.on('connect', function () {
            console.log('conectado!')
            socket.emit('join', "224");
            document.getElementById('greenDiv').style.display = 'none';
            document.getElementById('blueDiv').style.display = 'block';
            document.querySelectorAll('.redDiv').forEach(div => {
                div.style.display = 'none';
            });
        })
        socket.on('text', function (response) {
            if (response['text'] != "...") {
                document.getElementById('textPrompt').innerHTML = response['text'];
                
            }
        });
        socket.on('type', function (response) {
            console.log(response['type'])
            if (response['type'] === "Votes") {
                document.getElementById('divTypePrompt').innerHTML = '<div class="w3-container w3-blue w3-round-xlarge" style="width:25%">25%</div>';
                console.log("Entro chatVotes")
            }
            if (response['type'] === "MultipleOptions") {
                console.log("Entr√≥ multiple options")
                //document.getElementById('divTypePrompt').innerHTML = '<div id="columnaOptions">';
            }
        });

        socket.on('timer', function (response) {
            document.getElementById('timerPrompt').innerHTML = response['timer'];
            if(response['timer'] === 0){
                document.getElementById('divTypePrompt').innerHTML = '';
            }
        });

        socket.on('option_1', function (response) {
            console.log(response['option_1'])
            var divElement = document.getElementById('divTypePrompt');
            var contenidoActual = divElement.innerHTML;
            var nuevoContenido = contenidoActual + '<div id="columnaOptions">' + response['option_1']+'</div>';
            divElement.innerHTML = nuevoContenido;
        });
        socket.on('option_2', function (response) {
            var divElement = document.getElementById('divTypePrompt');
            var contenidoActual = divElement.innerHTML;
            var nuevoContenido = contenidoActual + '<div id="columnaOptions">' + response['option_2']+'</div>';
            divElement.innerHTML = nuevoContenido;
        });
        socket.on('option_3', function (response) {
            var divElement = document.getElementById('divTypePrompt');
            var contenidoActual = divElement.innerHTML;
            var nuevoContenido = contenidoActual + '<div id="columnaOptions">' + response['option_3']+'</div>';
            divElement.innerHTML = nuevoContenido;
             });

        socket.on('option_4', function (response) {
            var divElement = document.getElementById('divTypePrompt');
            var contenidoActual = divElement.innerHTML;
            var nuevoContenido = contenidoActual + '<div id="columnaOptions">' + response['option_4']+'</div>';
            divElement.innerHTML = nuevoContenido;
        });

        socket.on('start', function (response) {
            console.log("Start param" + response['start'])
            if (lobbyShow === true) {
                if (response['start'] === 0) {
                    document.getElementById('blueDiv').style.display = 'block';
                    document.querySelectorAll('.redDiv').forEach(div => {
                        div.style.display = 'none';
                    });
                } else if (response['start'] === 1) {
                    document.getElementById('blueDiv').style.display = 'none';
                    document.querySelectorAll('.redDiv').forEach(div => {
                        div.style.display = 'block';
                    });
                }

                lobbyShow = false
            }
        });
    </script>
</body>

</html>